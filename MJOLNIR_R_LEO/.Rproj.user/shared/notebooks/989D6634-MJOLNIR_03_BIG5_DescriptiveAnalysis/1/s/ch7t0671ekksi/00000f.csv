"0","f_semscoring_latent <- function(fit, data, scaled = TRUE){"
"0","  "
"0","  df_sem_estimate <- fit %>% lavaan::partable() %>% as_tibble %>% filter(user==1)"
"0","  v_latent_var <- df_sem_estimate$lhs %>% as_factor %>% levels"
"0","  "
"0","  f_calculate_latent <- function(latent_var){"
"0","    "
"0","    v_obs_var <- df_sem_estimate %>% filter(lhs==latent_var) %>% select(rhs) %>% as_vector()"
"0","    "
"0","    f_calculate_obs <- function(obs_var){"
"0","    "
"0","      res <- scale(data[,obs_var]) * (df_sem_estimate %>% filter(lhs==latent_var, rhs==obs_var) %>% select(est) %>% as_vector())"
"0","      return(res)"
"0","    }"
"0","    "
"0","    res <- map(v_obs_var, function(x){f_calculate_obs(x)}) %>% as_tibble %>% rowSums"
"0","    if(scaled) res <- res %>% scale"
"0","    return(res)"
"0","  }"
"0","  "
"0","  res <- map(v_latent_var,function(x){f_calculate_latent(x)}) %>% as.data.frame"
"0","  colnames(res) <- v_latent_var"
"0","  return(res)"
"0","}"
